<div class="bg-gray-900 border border-gray-800 rounded-2xl shadow-2xl overflow-hidden text-white">
    <div class="p-6">
        <h4 class="text-xl font-black flex items-center mb-6 uppercase tracking-[0.2em]">
            <i class="fa fa-file-invoice mr-3 text-joel-red"></i> Paiements
        </h4>
        <div class="space-y-6">
            <div class="bg-white/5 rounded-2xl p-5 backdrop-blur-sm border border-white/10">
                <h6 class="text-[10px] font-black text-gray-400 mb-4 flex items-center uppercase tracking-[0.2em]">
                    <i class="fa fa-calculator mr-2"></i> Composition du prix
                </h6>
                <div class="space-y-3">
                    <div class="flex justify-between text-sm py-1 border-b border-white/5">
                        <div class="flex items-center text-gray-300">
                            <i class="fa fa-car mr-3 w-4 opacity-30"></i>
                            <span>Location Véhicule</span>
                        </div>
                        <span class="font-bold">{{ reservation.tarifVehicule }}€</span>
                    </div>
                    <div class="flex justify-between text-sm py-1 border-b border-white/5">
                        <div class="flex items-center text-gray-300">
                            <i class="fa fa-cog mr-3 w-4 opacity-30"></i>
                            <span>Options</span>
                        </div>
                        <span class="font-bold">{{ reservation.prixOptions }}€</span>
                    </div>
                    <div class="flex justify-between text-sm py-1 border-b border-white/5">
                        <div class="flex items-center text-gray-300">
                            <i class="fa fa-shield mr-3 w-4 opacity-30"></i>
                            <span>Garanties</span>
                        </div>
                        <span class="font-bold">{{ reservation.prixGaranties }}€</span>
                    </div>

                    <div class="flex justify-between py-4 mt-2 items-center">
                        <div class="flex flex-col">
                            <span class="text-[10px] text-gray-500 font-black uppercase tracking-widest">A payer au
                                total</span>
                            <span class="text-3xl font-black text-white tracking-tighter">{{ reservation.prix }}€</span>
                        </div>
                        <div class="bg-joel-red text-white p-3 rounded-xl shadow-lg shadow-joel-red/30">
                            <i class="fa fa-credit-card text-xl"></i>
                        </div>
                    </div>
                </div>
            </div>

            {% if type != 'devis' %}
            <div class="bg-white/5 rounded-2xl p-5 border border-white/10">
                <h6 class="text-[10px] font-black text-gray-400 mb-4 flex items-center uppercase tracking-[0.2em]">
                    <i class="fa fa-history mr-2"></i> Transactions
                </h6>
                <div class="space-y-3">
                    {% for paiement in reservation.paiements %}
                    <div class="flex justify-between items-center bg-white/5 p-3 rounded-xl border border-white/5">
                        <div class="flex items-center">
                            <div
                                class="w-8 h-8 rounded-lg bg-green-500/20 text-green-400 flex items-center justify-center mr-3 font-bold text-xs">
                                <i class="fa fa-check"></i>
                            </div>
                            <div class="flex flex-col">
                                <span class="text-xs font-bold">{{ paiement.datePaiement|date('d/m/Y') }}</span>
                                <span class="text-[10px] text-gray-500 uppercase font-medium">{{
                                    paiement.modePaiement.libelle }}</span>
                            </div>
                        </div>
                        <span class="font-black text-green-400">{{ paiement.montant }}€</span>
                    </div>
                    {% else %}
                    <div
                        class="text-gray-500 py-6 text-center text-xs flex flex-col items-center justify-center gap-3 border border-dashed border-white/10 rounded-xl">
                        <i class="fa fa-info-circle text-2xl opacity-10"></i>
                        Aucun paiement à ce jour
                    </div>
                    {% endfor %}
                </div>
            </div>

            {% if reservation.prix == reservation.sommePaiements %}
            <div
                class="bg-green-500/20 border border-green-500/30 text-green-400 p-4 rounded-xl flex items-center justify-center gap-3">
                <i class="fas fa-check-double shadow-sm"></i>
                <span class="font-black text-xs uppercase tracking-widest">SÉJOUR ENTIÈREMENT RÉGLÉ</span>
            </div>
            {% else %}
            <div class="bg-white text-gray-900 p-5 rounded-2xl space-y-3 shadow-xl">
                <div class="flex justify-between text-xs font-bold text-gray-500 uppercase tracking-widest">
                    <span>Déjà réglé</span>
                    <span>{{ reservation.sommePaiements }}€</span>
                </div>
                <div class="w-full bg-gray-100 h-2 rounded-full overflow-hidden">
                    {% set percent = (reservation.sommePaiements / reservation.prix * 100)|round %}
                    <div class="bg-joel-red h-full rounded-full" style="width: {{ percent }}%"></div>
                </div>
                <div class="flex justify-between items-end">
                    <span class="text-[10px] font-black text-gray-400 uppercase tracking-tighter">Solde à régler</span>
                    <span class="text-xl font-black text-joel-red">{{ reservation.prix - reservation.sommePaiements
                        }}€</span>
                </div>
            </div>
            {% endif %}
            {% endif %}
        </div>
    </div>
</div>