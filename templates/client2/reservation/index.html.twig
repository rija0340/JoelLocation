{% extends 'baseClient2.html.twig' %}

{% block title %}Mes Réservations
{% endblock %}
{% block stylesheets %}{% endblock %}

{% block body %}
	<div class="space-y-8">
		<!-- En-tête -->
		<header class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0">
			<div>
				<div class="flex items-center mb-2">
					<h1 class="text-3xl font-bold text-joel-red">Mes Réservations</h1>
					<div class="ml-4 w-12 h-1 bg-joel-red"></div>
				</div>
				<p class="text-gray-600">Consultez et gérez vos locations de voitures</p>
			</div>
			<a href="{{ path('client_step1') }}"
			   class="inline-flex items-center px-6 py-3 bg-joel-red text-white font-semibold rounded-lg hover:bg-joel-red-dark transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 w-full sm:w-auto justify-center">
				<i class="fas fa-plus mr-2"></i>
				Nouvelle Réservation
			</a>
		</header>

		<!-- Barre de recherche & filtre -->
		<div class="hidden bg-white rounded-lg shadow-md p-6">
			<div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0">
				<div class="flex items-center w-full md:w-2/3">
					<div class="relative w-full">
						<span class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400">
							<i class="fas fa-search"></i>
						</span>
						<input id="searchInput" type="text" placeholder="Rechercher des réservations..."
							   class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-joel-red focus:border-transparent"/>
					</div>
				</div>
				<div class="w-full md:w-auto">
					<select id="sortSelect" class="w-full md:w-auto px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-joel-red focus:border-transparent">
						<option value="date-desc">Plus récent d'abord</option>
						<option value="date-asc">Plus ancien d'abord</option>
						<option value="price-desc">Prix décroissant</option>
						<option value="price-asc">Prix croissant</option>
					</select>
				</div>
			</div>
		</div>

		<!-- Custom Tabs -->
		<div class="bg-white rounded-lg shadow-md overflow-hidden">
			<div class="flex flex-wrap border-b border-gray-200" id="reservationTabs">
				<button class="tab-button flex items-center px-6 py-4 text-lg font-medium transition-all duration-300 border-b-2 border-transparent hover:bg-gray-50 active"
						data-tab="devis" onclick="switchTab('devis')">
					<i class="fas fa-file-invoice mr-2 text-joel-red"></i>
					<span class="text-joel-red">Devis</span>
					<span class="ml-2 px-2 py-1 bg-gray-200 text-gray-700 text-sm rounded-full">{{ devis|length }}</span>
				</button>
				<button class="tab-button flex items-center px-6 py-4 text-lg font-medium transition-all duration-300 border-b-2 border-transparent hover:bg-gray-50"
						data-tab="encours" onclick="switchTab('encours')">
					<i class="fas fa-spinner mr-2"></i>
					<span>En cours</span>
					<span class="ml-2 px-2 py-1 bg-gray-200 text-gray-700 text-sm rounded-full">{{ reservationEncours|length }}</span>
				</button>
				<button class="tab-button flex items-center px-6 py-4 text-lg font-medium transition-all duration-300 border-b-2 border-transparent hover:bg-gray-50"
						data-tab="avenir" onclick="switchTab('avenir')">
					<i class="fas fa-calendar-alt mr-2"></i>
					<span>À venir</span>
					<span class="ml-2 px-2 py-1 bg-gray-200 text-gray-700 text-sm rounded-full">{{ reservationAvenir|length }}</span>
				</button>
				<button class="tab-button flex items-center px-6 py-4 text-lg font-medium transition-all duration-300 border-b-2 border-transparent hover:bg-gray-50"
						data-tab="termine" onclick="switchTab('termine')">
					<i class="fas fa-check-circle mr-2"></i>
					<span>Terminé</span>
					<span class="ml-2 px-2 py-1 bg-gray-200 text-gray-700 text-sm rounded-full">{{ reservationEffectuers|length }}</span>
				</button>
			</div>

			<!-- Tab Panels -->
			<div class="p-6" id="reservationPanels">
				<div class="tab-panel" data-tab="devis">
					{% include 'client2/reservation/parts/devis.html.twig' %}
				</div>
				<div class="tab-panel hidden" data-tab="encours">
					{% include 'client2/reservation/parts/encours.html.twig' %}
				</div>
				<div class="tab-panel hidden" data-tab="avenir">
					{% include 'client2/reservation/parts/avenir.html.twig' %}
				</div>
				<div class="tab-panel hidden" data-tab="termine">
					{% include 'client2/reservation/parts/termines.html.twig' %}
				</div>
			</div>
		</div>
	</div>
{% endblock %}

{% block javascripts %}
<script>
function switchTab(tabName) {
    // Remove active class from all tab buttons
    document.querySelectorAll('.tab-button').forEach(button => {
        button.classList.remove('active', 'border-joel-red');
        button.classList.add('border-transparent');
        // Reset text colors
        const span = button.querySelector('span');
        const icon = button.querySelector('i');
        if (span) span.classList.remove('text-joel-red');
        if (icon) icon.classList.remove('text-joel-red');
    });

    // Hide all tab panels
    document.querySelectorAll('.tab-panel').forEach(panel => {
        panel.classList.add('hidden');
    });

    // Add active class to clicked tab button
    const activeButton = document.querySelector(`[data-tab="${tabName}"]`);
    if (activeButton) {
        activeButton.classList.add('active', 'border-joel-red');
        activeButton.classList.remove('border-transparent');
        // Set active text colors
        const span = activeButton.querySelector('span');
        const icon = activeButton.querySelector('i');
        if (span) span.classList.add('text-joel-red');
        if (icon) icon.classList.add('text-joel-red');
    }

    // Show corresponding tab panel
    const activePanel = document.querySelector(`.tab-panel[data-tab="${tabName}"]`);
    if (activePanel) {
        activePanel.classList.remove('hidden');
    }
}

// Initialize first tab as active
document.addEventListener('DOMContentLoaded', function() {
    switchTab('devis');
});
</script>
	<script src="{{ asset('client2/js/reservation/tabsystem.js') }}"></script>
{% endblock %}
