{% extends 'baseClient2.html.twig' %}

{% block title %}Réservation
{% endblock %}

{% block stylesheets %}
	{# plus besoin de CSS custom ni Bootstrap ici #}
{% endblock %}

{% block body %}


	<div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0 py-0">
		<div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0">
			<div>
				<h1 class="text-3xl title-red">Etape 2
				</h1>
				<p class="text-gray-500">Choix de véhicule</p>
			</div>

		</div>

		{% include 'client2/reservation/nouvelle_resa/parts/_step_navigation.html.twig' with { currentStep: 2 } %}

	</div>


<!-- Action Buttons - Top -->
<div class="bg-white border border-gray-200 rounded-lg shadow-sm p-6 mb-6">
    <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
        <a href="{{ path('client_step1') }}"
           class="inline-flex items-center justify-center px-6 py-3 border-2 border-joel-dark text-joel-dark hover:bg-joel-dark hover:text-white rounded-lg transition-colors duration-200 text-base font-medium min-w-[200px]">
            <i class="fa fa-arrow-left mr-2"></i>
            Revenir à l'étape précédente
        </a>

        {% if vehiculesDisponible|length > 0 %}
            <button type="submit"
                    class="inline-flex items-center justify-center px-6 py-3 bg-joel-red hover:bg-joel-red-dark text-white rounded-lg transition-colors duration-200 text-base font-medium min-w-[200px]"
                    form="formStep2">
                <i class="fa fa-save mr-2"></i>
                Enregistrer
            </button>
        {% endif %}
    </div>
</div>


	<form action="{{ path('client_step2') }}" method="post" id="formStep2" class="space-y-4">

		{% if vehiculesDisponible|length > 0 %}
			{% for vehicule in vehiculesDisponible %}
				{% if vehicule is not null %}
					{% include 'client2/reservation/nouvelle_resa/parts/step2_vehicule.html.twig' %}
				{% endif %}
			{% endfor %}
		{% else %}
			<div class="bg-white shadow p-6 rounded-xl text-center">
				<h3 class="text-lg">
					Il n'y a pas de véhicules disponibles du
					<span class="font-semibold">{{ dateDepart|date('d/m/Y') }}</span>
					au
					<span class="font-semibold">{{ dateRetour|date('d/m/Y') }}</span>
				</h3>
			</div>
		{% endif %}

		{# <div class="flex justify-center">
																							<div>
																								{{ knp_pagination_render(vehiculesDisponiblePagination) }}
																							</div>
																						</div> #}

	<!-- Action Buttons - Top -->
	<div class="bg-white border border-gray-200 rounded-lg shadow-sm p-6 mb-6">
		<div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
			<a href="{{ path('client_step1') }}"
			class="inline-flex items-center justify-center px-6 py-3 border-2 border-joel-dark text-joel-dark hover:bg-joel-dark hover:text-white rounded-lg transition-colors duration-200 text-base font-medium min-w-[200px]">
				<i class="fa fa-arrow-left mr-2"></i>
				Revenir à l'étape précédente
			</a>

			{% if vehiculesDisponible|length > 0 %}
				<button type="submit"
						class="inline-flex items-center justify-center px-6 py-3 bg-joel-red hover:bg-joel-red-dark text-white rounded-lg transition-colors duration-200 text-base font-medium min-w-[200px]"
						form="formStep2">
					<i class="fa fa-save mr-2"></i>
					Enregistrer
				</button>
			{% endif %}
		</div>
	</div>
	</form>
{% endblock %}

{% block javascripts %}

	<script>
		document.querySelectorAll('input[name="vehicule"]').forEach(input => {
			const label = input.nextElementSibling;
			const textSpan = label.querySelector('.js-btn-text');

			// Initialize state on page load
			if (input.checked) {
				label.classList.remove('border-joel-red', 'text-joel-red');
				label.classList.add('bg-joel-red', 'text-white');
				textSpan.textContent = 'Sélectionné';
				label.dataset.selected = 'true';
			}

			// Handle change event
			input.addEventListener('change', () => {
				// Reset all buttons
				document.querySelectorAll('.js-vehicle-btn').forEach(otherLabel => {
					otherLabel.classList.remove('bg-joel-red', 'text-white');
					otherLabel.classList.add('border-joel-red', 'text-joel-red');
					otherLabel.querySelector('.js-btn-text').textContent = 'Choisir';
					otherLabel.dataset.selected = 'false';
				});

				// Update selected button
				if (input.checked) {
					label.classList.remove('border-joel-red', 'text-joel-red');
					label.classList.add('bg-joel-red', 'text-white');
					textSpan.textContent = 'Sélectionné';
					label.dataset.selected = 'true';
				}
			});
		});
	</script>

{% endblock %}
