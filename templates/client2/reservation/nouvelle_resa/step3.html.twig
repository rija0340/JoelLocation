{% extends 'baseClient2.html.twig' %}

{% block title %}Réservation
{% endblock %}


{% block body %}


	{% if step is defined and step == 'validation' %}

		<div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0 py-6">
			<div>
				<h1 class="text-3xl title-red">Validation de devis
				</h1>
				<p class="text-gray-500">Vous pouvez modifier vos choix</p>
			</div>

		</div>
	{% else %}
		<div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0 py-0">
			<div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0">
				<div>
					<h1 class="text-3xl title-red">Etape 3
					</h1>
					<p class="text-gray-500">Choix des options et garanties</p>
				</div>

			</div>

			<div class="grid grid-cols-2 md:grid-cols-4 gap-4 my-4">
				<div class="text-center">
					<div class="badge badge-success w-10 h-10 rounded-full flex items-center justify-center mx-auto">
						<i class="fa fa-check text-white"></i>
					</div>
					<p class="mt-2 text-sm">Agences & Dates</p>
				</div>
				<div class="text-center">
					<div class="badge badge-success w-10 h-10 rounded-full flex items-center justify-center mx-auto">
						<i class="fa fa-check text-white"></i>
					</div>
					<p class="mt-2 text-sm">Véhicules</p>
				</div>
				<div class="text-center">
					<div class="badge badge-primary w-10 h-10 rounded-full flex items-center justify-center mx-auto">
						3
					</div>
					<p class="mt-2 text-sm">Options et garanties</p>
				</div>
				<div class="text-center">
					<div class="badge badge-outline w-10 h-10 rounded-full flex items-center justify-center mx-auto">
						4
					</div>
					<p class="mt-2 text-sm">Récapitulatif</p>
				</div>
			</div>

		</div>
	{% endif %}
	{% if vehiculeIsNotAvailable is defined and vehiculeIsNotAvailable %}
		<div aria-live="assertive" role="alert" class="mx-4 my-6 flex justify-center">
			<div class="alert alert-error shadow-lg w-full max-w-2xl rounded-lg relative">
				<div
					class="flex gap-4 items-start flex-col sm:flex-row">
					<!-- Icon -->
					<div class="flex-shrink-0">
						<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 stroke-current" fill="none" viewbox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
						</svg>
					</div>

					<!-- Message -->
					<div class="flex-1 min-w-0">
						<p class="font-semibold text-lg">Véhicule indisponible</p>
						<p class="mt-1 text-sm">
							Ce véhicule n’est plus disponible. Choisissez une autre option ou lancez une nouvelle réservation.
						</p>

						<!-- Actions -->
						<div class="mt-3 flex flex-wrap gap-2">
							<a
								href="{{ path('client_step1') }}" class="btn btn-sm btn-primary flex items-center gap-1">
								<!-- Restart icon -->
								<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewbox="0 0 24 24" stroke="currentColor">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582M19.4 15A9 9 0 115 6.6M20 20l-4-4"/>
								</svg>
								Nouvelle réservation
							</a>
							<a
								href="{{ path('client_reservations') }}" class="btn btn-sm btn-outline flex items-center gap-1">
								<!-- List / calendar icon -->
								<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewbox="0 0 24 24" stroke="currentColor">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h8M8 11h8M8 15h5M4 6h16v12H4z"/>
								</svg>
								Mes réservations
							</a>
						</div>
					</div>
				</div>

				<!-- Dismiss button -->
				<button aria-label="Fermer" type="button" class="btn btn-xs btn-ghost absolute top-2 right-2" onclick="this.closest('[role=alert]').style.display='none'">
					<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewbox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
					</svg>
				</button>
			</div>
		</div>

	{% endif %}

	{# {% else %} #}
	{# <input type="hidden" id="options_garanties_data" data-vehiculeisnotavailable=" {{ vehiculeIsNotAvailable }}" data-selected-options="{{dataOptions|json_encode()}}" data-selected-garanties="{{dataGaranties|json_encode()}}" data-options="{{allOptions|json_encode()}}" data-garanties="{{allGaranties|json_encode()}}"> #}


	<div class="text-center mb-2">
		{% if step is defined and step == 'validation' %}
			<a href="{{ path('client_reservations') }}" class="btn btn-neutral mr-2">
				<i class="fa fa-return mr-2"></i>
				Revenir à mes réservations
			</a>
		{% else %}
			<a href="{{ path('client_step2') }}" class="btn btn-neutral mr-2">
				Revenir à l'étape précédente
			</a>
		{% endif %}

		{% if vehiculeIsNotAvailable is not defined or not vehiculeIsNotAvailable %}
			<button type="submit" class="btn btn-error" form="options_garanties" id="btnEnregistrer1">
				Enregistrer
			</button>
		{% endif %}

	</div>


	<input type="hidden" id="options_garanties_data" data-selected-options="{{ dataOptions|json_encode() }}" data-selected-garanties="{{ dataGaranties|json_encode() }}" data-options="{{ allOptions|json_encode() }}" data-garanties="{{ allGaranties|json_encode() }}">

	<form {% if step is defined and step == 'validation' %} action="{{path('validation_step2',{'id':devis.id})}}" {% else %} action="{{ path('client_step3') }}" {% endif %} method="post" id="options_garanties">

		{% if step is defined and step == 'validation' %}
			<input type="hidden" name="editedOptionsGaranties" value="true">
		{% endif %}
		<div class="flex flex-col md:flex-row gap-6">
			<div class="w-full md:w-1/4">
				{% include "client2/reservation/nouvelle_resa/parts/sidebarResaResume.html.twig" %}
			</div>
			<div class="w-full md:w-3/4">
				{% include "client2/reservation/nouvelle_resa/parts/step2OptionsGaranties.html.twig" %}
			</div>
		</div>
	</form>

	<div class="text-center mb-2">
		{% if step is defined and step == 'validation' %}
			<a href="{{ path('client_reservations') }}" class="btn btn-neutral mr-2">
				<i class="fa fa-return mr-2"></i>
				Revenir à mes réservations
			</a>
		{% else %}
			<a href="{{ path('client_step2') }}" class="btn btn-neutral mr-2">
				Revenir à l'étape précédente
			</a>
		{% endif %}

		{% if vehiculeIsNotAvailable is not defined or not vehiculeIsNotAvailable %}
			<button type="submit" class="btn btn-error" form="options_garanties" id="btnEnregistrer1">
				Enregistrer
			</button>
		{% endif %}

	</div>
{% endblock %}

{% block javascripts %}{% endblock %}
