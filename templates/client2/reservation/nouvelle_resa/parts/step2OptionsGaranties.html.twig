<!-- üü¶ Bloc: Vos options -->
<div class="card shadow-lg bg-base-100 mb-8 rounded-xl">
	<div class="card-body p-6">
		<h3 class="text-2xl title-red mb-4 flex items-center">
			<i class="fas fa-chevron-right mr-3 text-error"></i>
			Vos options
		</h3>

		<div
			class="grid grid-cols-1 md:grid-cols-2 gap-6">
			<!-- üü© Conducteur additionnel -->
			<div class="flex flex-col md:flex-row gap-4 bg-base-50 p-4 rounded-lg group hover:shadow-md transition-all duration-300 transform hover:-translate-y-1">
				<div class="w-full md:w-1/3">
					<div class="card bg-base-200 shadow-sm rounded-xl overflow-hidden">
						<div class="relative w-full h-32 bg-gradient-to-br from-primary/20 to-secondary/20 flex items-center justify-center">
							<img src="{{asset('images/options_garanties/CONDUCTEUR_ADDITIONNEL.png')}}" alt="Conducteur additionnel" class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity duration-300" onerror="this.classList.add('hidden'); this.nextElementSibling.classList.remove('hidden');">
							<div class="hidden absolute inset-0 flex items-center justify-center">
								<i class="fas fa-user-plus text-4xl text-primary opacity-50 group-hover:opacity-75 transition-opacity duration-300"></i>
							</div>
							<div class="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent opacity-50 group-hover:opacity-30 transition-opacity duration-300"></div>
						</div>
					</div>
				</div>
				<div class="w-full md:w-2/3">
					<h5 class="text-lg font-semibold text-accent mb-2">Conducteur additionnel</h5>
					<p class="text-sm text-base-content mb-3">
						√Ä Joel Location, nous savons que les longs trajets peuvent √™tre fatigants. Ajoutez un conducteur suppl√©mentaire pour plus de confort.
					</p>
					<div class="flex gap-4">
						<label class="flex items-center gap-2 cursor-pointer">
							<input type="radio" name="radio-conducteur" value="true" class="radio radio-danger checked:bg-danger" {% if devis.conducteur %} checked {% endif %}>
							<span class="font-semibold text-base-content">Oui ({{ prixConductSuppl }}
								‚Ç¨)</span>
						</label>
						<label class="flex items-center gap-2 cursor-pointer">
							<input type="radio" name="radio-conducteur" value="false" class="radio radio-danger checked:bg-danger" {% if devis.conducteur == false %} checked {% endif %}>
							<span class="font-semibold text-base-content">Non</span>
						</label>
					</div>
				</div>
			</div>

			<!-- üü® Si√®ge enfant / b√©b√© -->
			<div class="flex flex-col md:flex-row gap-4 bg-base-50 p-4 rounded-lg group hover:shadow-md transition-all duration-300 transform hover:-translate-y-1">
				<div class="w-full md:w-1/3">
					<div class="card bg-base-200 shadow-sm rounded-xl overflow-hidden">
						<div class="relative w-full h-32 bg-gradient-to-br from-primary/20 to-secondary/20 flex items-center justify-center">
							<img src="{{asset('images/options_garanties/SIEGE.jpg')}}" alt="Si√®ge b√©b√© / enfant" class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity duration-300" onerror="this.classList.add('hidden'); this.nextElementSibling.classList.remove('hidden');">
							<div class="hidden absolute inset-0 flex items-center justify-center">
								<i class="fas fa-child text-4xl text-primary opacity-50 group-hover:opacity-75 transition-opacity duration-300"></i>
							</div>
							<div class="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent opacity-50 group-hover:opacity-30 transition-opacity duration-300"></div>
						</div>
					</div>
				</div>
				<div class="w-full md:w-2/3">
					<h5 class="text-lg font-semibold text-accent mb-2">Si√®ge b√©b√© / enfant</h5>
					<p class="text-sm text-base-content mb-3">Nous mettons √† disposition des si√®ges homologu√©s NF pour la s√©curit√© de vos enfants.</p>
					<div class="space-y-3">
						{% for option in allOptions %}
							{% if option.type == "si√®ge" %}
								{% if option.appelation matches '/Si√®ge/' %}
									<div class="flex items-center gap-3">

										<div class="flex items-center border border-base-200 rounded-lg shadow-sm hover:border-primary/50 transition-colors duration-200">
											<button class="btn btn-sm btn-square btn-ghost text-base-content hover:bg-primary/10 hover:text-primary font-bold p-1.5 transition-colors duration-200" id="decrement_{{ option.id }}" aria-label="Decrement quantity">-</button>

											<input type="number" class="w-14 text-base text-center bg-transparent text-base-content border-x border-base-200 px-2 hover:bg-base-50 focus:outline-none focus:ring-2 focus:ring-primary/50 transition-all duration-200" name="siege_{{ option.id }}" id="number_{{ option.id }}" value="{% if option.id in devis.devisOptions|map(item => item.opt.id) %}{{ devis.devisOptions|filter(item => item.opt.id == option.id)|first.quantity }}{% else %}0{% endif %}" min="0" max="3" placeholder="0">

											<button class="btn btn-sm btn-square btn-ghost text-base-content hover:bg-primary/10 hover:text-primary font-bold p-1.5 transition-colors duration-200" id="increment_{{ option.id }}" aria-label="Increment quantity">+</button>
										</div>

										<span class="text-sm font-medium text-base-content">{{ option.appelation }}</span>
									</div>
								{% else %}
									<label class="flex items-center gap-2 cursor-pointer">
										<input type="checkbox" name="checkboxOptions[]" value="{{ option.id }}" class="checkbox checkbox-danger checked:bg-danger" {% if option.id in devis.devisOptions|map(item => item.opt.id) %} checked {% endif %}>
										<span class="text-sm font-medium text-base-content">
											{{ option.appelation }}
											{% if option.prix != 0 %}:
												{{ option.prix }}
												‚Ç¨
											{% endif %}
										</span>
									</label>
								{% endif %}
							{% endif %}
						{% endfor %}
					</div>
				</div>
			</div>

			<!-- üüß Autres options -->
			{% for option in allOptions %}

			{% set image_url = option.appelation|replace({' : ' : '_',' ': '_'})|lower %}
			{% set image_url = 'images/options_garanties/' ~ image_url ~ '.png'  %}

				{% if option.type != "si√®ge" %}
					<div class="flex flex-col md:flex-row gap-4 bg-base-50 p-4 rounded-lg group hover:shadow-md transition-all duration-300 transform hover:-translate-y-1">
						<div class="w-full md:w-1/3">
							<div class="card bg-base-200 shadow-sm rounded-xl overflow-hidden">
								<div class="relative w-full h-32 bg-gradient-to-br from-primary/20 to-secondary/20 flex items-center justify-center">
									<img src="{{asset(image_url)}}" alt="{{ option.appelation }}" class="w-full h-full object-cover  group-hover:opacity-100 transition-opacity duration-300" onerror="this.classList.add('hidden'); this.nextElementSibling.classList.remove('hidden');">
									<div class="hidden absolute inset-0 flex items-center justify-center">
										<i class="fas fa-cog text-4xl text-primary opacity-50 group-hover:opacity-75 transition-opacity duration-300"></i>
									</div>
									<div class="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent opacity-50 group-hover:opacity-30 transition-opacity duration-300"></div>
								</div>
							</div>
						</div>
						<div class="w-full md:w-2/3">
							<h5 class="text-lg font-semibold text-accent mb-2">{{ option.appelation }}</h5>
							<p class="text-sm text-base-content mb-3">{{ option.description|raw }}</p>
							<label class="flex items-center gap-2 cursor-pointer">
								<input type="checkbox" name="checkboxOptions[]" value="{{ option.id }}" class="checkbox checkbox-danger checked:bg-danger" {% if option.id in devis.devisOptions|map(item => item.opt.id) %} checked {% endif %}>
								<span class="text-sm font-medium text-base-content">{{ option.appelation }}:
									{{ option.prix }}
									‚Ç¨</span>
							</label>
						</div>
					</div>
				{% endif %}
			{% endfor %}
		</div>
	</div>
</div>

<!-- üü• Bloc: Vos garanties -->
<div class="card shadow-lg bg-base-100 mb-8 rounded-xl">
	<div class="card-body p-6">
		<h3 class="text-2xl title-red mb-4 flex items-center">
			<i class="fas fa-chevron-right mr-3 text-error"></i>
			Vos garanties
		</h3>

		<div class="grid grid-cols-1 md:grid-cols-2 gap-6">

			{% for garantie in allGaranties %}

			{% set image_url = garantie.appelation|replace({' & ' : '_',' ' : '_'})|lower %}

			{% if image_url == "assistance_esprit_tranquille"  %}
			 	{% set image_url = 'images/options_garanties/assitance_esprit_tranquille.png'  %}
			 {% else %}
			 	{% set image_url = 'images/options_garanties/' ~ image_url ~ '.png'  %}
			{% endif %}

				<div class="flex flex-col md:flex-row gap-4 bg-base-50 p-4 rounded-lg group hover:shadow-md transition-all duration-300 transform hover:-translate-y-1">
					<div class="w-full md:w-1/3">
						<div class="card bg-base-200 shadow-sm rounded-xl overflow-hidden">
							<div class="relative w-full h-32 bg-gradient-to-br from-primary/20 to-secondary/20 flex items-center justify-center">
								<img src="{{asset(image_url)}}" alt="{{ garantie.appelation }}" class="w-full h-full object-cover  group-hover:opacity-100 transition-opacity duration-300" onerror="this.classList.add('hidden'); this.nextElementSibling.classList.remove('hidden');">
								<div class="hidden absolute inset-0 flex items-center justify-center">
									<i class="fas fa-shield-alt text-4xl text-primary opacity-50 group-hover:opacity-75 transition-opacity duration-300"></i>
								</div>
								<div class="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent opacity-50 group-hover:opacity-30 transition-opacity duration-300"></div>
							</div>
						</div>
					</div>
					<div class="w-full md:w-2/3">
						<h5 class="text-lg font-semibold text-accent mb-2">{{ garantie.appelation }}</h5>
						<p class="text-sm text-base-content mb-3">{{ garantie.description }}</p>
						<label class="flex items-center gap-2 cursor-pointer">
							<input type="checkbox" name="checkboxGaranties[]" value="{{ garantie.id }}" class="checkbox checkbox-danger checked:bg-danger" {% if garantie.id in devis.garanties|map(item => item.id) %} checked {% endif %}>
							<span class="text-sm font-medium text-base-content">{{ garantie.prix }}
								‚Ç¨</span>
						</label>
					</div>
				</div>
			{% endfor %}
		</div>
	</div>
</div>

<script>
	// Optimized increment/decrement logic for seat options
document.querySelectorAll('[id^="number_"]').forEach((input) => {
const suffix = input.id.split('_')[1];
const decrementBtn = document.querySelector(`#decrement_${suffix}`);
const incrementBtn = document.querySelector(`#increment_${suffix}`);

decrementBtn.addEventListener('click', (e) => {
e.preventDefault();
const val = parseInt(input.value, 10);
if (val > parseInt(input.min, 10)) {
input.value = val - 1;
}
});

incrementBtn.addEventListener('click', (e) => {
e.preventDefault();
const val = parseInt(input.value, 10);
if (val < parseInt(input.max, 10)) {
input.value = val + 1;
}
});
});
</script>
