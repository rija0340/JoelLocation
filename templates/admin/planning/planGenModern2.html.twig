{% extends 'base2.html.twig' %}

{% block title %}Planning Timeline - Vue Moderne{% endblock %}

{% block stylesheets %}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="{{ asset('css/admin/planning/timeline-planning.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="timeline-container">
    <!-- Header Controls -->
    <div class="timeline-header">
        <div class="header-left">
            <h1 class="page-title">Planning des Réservations</h1>
            <div class="header-stats">
                <span class="stat-item">
                    <span class="stat-label">Total Véhicules:</span>
                    <span class="stat-value" id="totalCars">-</span>
                </span>
                <span class="stat-item">
                    <span class="stat-label">Réservations Actives:</span>
                    <span class="stat-value" id="activeBookings">-</span>
                </span>
                <span class="stat-item">
                    <span class="stat-label">Utilisation:</span>
                    <span class="stat-value" id="utilization">-</span>
                </span>
            </div>
        </div>
        <div class="header-controls">
            <!-- Range Controls -->
            <div class="range-controls">
                <button class="control-btn" id="zoomInBtn" title="Zoom In">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"/>
                        <path d="M21 21l-4.35-4.35"/>
                        <line x1="11" y1="8" x2="11" y2="14"/>
                        <line x1="8" y1="11" x2="14" y2="11"/>
                    </svg>
                </button>
                <button class="control-btn" id="zoomOutBtn" title="Zoom Out">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"/>
                        <path d="M21 21l-4.35-4.35"/>
                        <line x1="8" y1="11" x2="14" y2="11"/>
                    </svg>
                </button>
                <button class="control-btn" id="resetZoomBtn" title="Réinitialiser">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 3v5h5"/>
                        <path d="M3 8a9 9 0 0 0 9 9h2a9 9 0 0 0 9-9V3"/>
                        <path d="M3 8h5"/>
                        <path d="M8 3v5"/>
                    </svg>
                </button>
            </div>
            
            <!-- Date Range Display -->
            <div class="date-range-display">
                <span class="date-label">Période:</span>
                <span class="date-range" id="dateRangeDisplay">-</span>
            </div>
            
            <!-- Quick Range Buttons -->
            <div class="quick-range-controls">
                <button class="quick-btn" data-range="7">7 Jours</button>
                <button class="quick-btn" data-range="30">30 Jours</button>
                <button class="quick-btn" data-range="90">3 Mois</button>
                <button class="quick-btn" data-range="365">1 An</button>
            </div>
        </div>
    </div>

    <!-- Timeline Content -->
    <div class="timeline-content">
        <!-- Car List Panel -->
        <div class="car-list-panel">
            <div class="car-list-header">
                <h3>Flotte</h3>
                <div class="car-list-controls">
                    <input type="text" placeholder="Rechercher véhicule..." id="carSearchInput" class="search-input">
                </div>
            </div>
            <div class="car-list" id="carList">
                <!-- Cars will be populated dynamically -->
            </div>
        </div>

        <!-- Timeline Panel -->
        <div class="timeline-panel">
            <!-- Timeline Header -->
            <div class="timeline-header-panel">
                <div class="timeline-dates" id="timelineDates">
                    <!-- Date headers will be populated dynamically -->
                </div>
            </div>
            
            <!-- Timeline Grid -->
            <div class="timeline-grid" id="timelineGrid">
                <!-- Grid lines will be populated dynamically -->
            </div>
            
            <!-- Booking Bars Container -->
            <div class="booking-container" id="bookingContainer">
                <!-- Booking bars will be populated dynamically -->
            </div>
        </div>
    </div>
</div>

<!-- Booking Details Modal -->
<div class="modal-overlay" id="bookingDetailsModal">
    <div class="modal">
        <div class="modal-header">
            <h3 class="modal-title">Détails de la Réservation</h3>
            <button class="modal-close" id="detailsModalClose">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
        </div>
        <div class="modal-body" id="bookingDetailsContent">
            <!-- Booking details will be populated dynamically -->
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" id="editBookingBtn">Modifier</button>
            <button type="button" class="btn btn-danger" id="deleteBookingBtn">Supprimer</button>
        </div>
    </div>
</div>

<!-- Toast Notifications -->
<div class="toast-container" id="toastContainer"></div>

{% endblock %}

{% block javascripts %}
    <script>
        // Pass the data endpoint to JavaScript
        window.PLANNING_DATA_URL = '{{ path('planningGeneralData') }}';
    </script>
    <script src="{{ asset('js/admin/planning/timeline-planning.js') }}"></script>
{% endblock %}
